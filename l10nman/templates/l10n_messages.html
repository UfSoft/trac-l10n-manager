<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
    xmlns:py="http://genshi.edgewall.org/"
    xmlns:xi="http://www.w3.org/2001/XInclude">
  <xi:include href="layout.html" />
  <head>
    <title>Translations</title>
    <script type="text/javascript">
      jQuery(document).ready( function($) {
        $('.more_lines').resizeable();
      });
    </script>
  </head>
  <body>
    <div id="content" class="translations">
      <div id="filter">
        <form action="" method="post">
          <fieldset>
            <legend>Filter Messages</legend>
            <input type="checkbox" name="show_translated" value="on"
                   checked="${show_translated and 'checked' or None}">Show translated</input>
            <input type="submit" value="Update"/>
          </fieldset>
        </form>
      </div>
      <h1>Messages for locale ${ catalog.locale or 'Unknown' }</h1>
      <py:if test="messages">
        <h2>
          Translations <span class="numresults">(${messages.displayed_items()})</span>
        </h2>
        <xi:include py:with="paginator = messages" href="page_index.html" />
      </py:if>

      <py:for each="msg in messages">
      <fieldset>
        <table class="translations"
               py:with="translations=msg.translations(catalog.id)">
          <tr>
            <th>English:</th>
            <td><span class="string">$msg.msgid</span></td>
          </tr>
          <tr py:with="locations=msg.locations">
            <th>Location(s):</th>
            <td><py:for each="loc in locations">
                <a href="$loc.href">$loc.fname:$loc.lineno</a>&nbsp;
              </py:for>
            </td>
          </tr>
          <tr>
            <th>&nbsp;</th>
            <td>
              <py:for each="trans in translations">
              <fieldset>
                <table class="translations">
                  <tr>
                    <th>Translation:</th>
                    <td><span class="string">$trans.string</span></td>
                  </tr>
                  <tr>
                    <th>SID</th>
                    <td>$trans.sid</td>
                  </tr>
                  <tr>
                    <th>Timestamp</th>
                    <td>${format_datetime(trans.ts)}</td>
                  </tr>
                </table>
              </fieldset>
              </py:for>
            </td>
          </tr>
          <tr>
            <th>New Translation:</th>
            <td><textarea cols="50" rows="2" class="more_lines" name="translation"/></td>
          </tr>
        </table>
      </fieldset>
      </py:for>

      <table class="listing">
        <tbody py:for="msg in messages">
          <tr>
            <th>MSGID</th>
            <td>$msg.msgid</td>
          </tr>
          <tr py:if="msg.msgstr">
            <th>MSGSTR</th>
            <td>$msg.msgstr</td>
          </tr>
          <tr py:if="msg.flags is not [u'']">
            <th>Flags</th>
            <td>$msg.flags</td>
          </tr>
          <tr py:if="msg.ac">
            <th>Auto-Comments</th>
            <td>$msg.ac</td>
          </tr>
          <tr py:if="msg.uc">
            <th>User-Comments</th>
            <td>$msg.uc</td>
          </tr>
          <tr>
            <th>Locations:</th>
            <td>
              <py:for each="loc in msg.locations">
                <a href="$loc.href">$loc.fname:$loc.lineno</a><br/>
              </py:for>
            </td>
          </tr>
          <tr><td colspan="2">&nbsp;</td></tr>
        </tbody>
      </table>
      <xi:include py:with="paginator = messages" href="page_index.html" />
    </div>
  </body>
</html>
